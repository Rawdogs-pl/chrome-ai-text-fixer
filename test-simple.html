<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chrome AI Text Fixer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        textarea {
            width: 100%;
            height: 150px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px;
            font-family: Arial, sans-serif;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: #f9f9f9;
        }
        .instructions {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>Test Chrome AI Text Fixer Extension</h1>
    
    <div class="instructions">
        <h3>Instrukcje testowania:</h3>
        <ol>
            <li>Załaduj rozszerzenie Chrome AI Text Fixer w przeglądarce</li>
            <li>Wprowadź klucz API Gemini w opcjach rozszerzenia</li>
            <li>Zaznacz tekst z błędami w polu poniżej</li>
            <li>Kliknij prawym przyciskiem myszy i wybierz "Popraw język z Gemini"</li>
            <li>LUB użyj skrótu klawiaturowego <strong>Ctrl+Shift+K</strong> (Cmd+Shift+K na Mac)</li>
        </ol>
    </div>
    
    <div class="test-section">
        <h2>Test 1: Podstawowy textarea</h2>
        <p>Ten test sprawdza czy rozszerzenie działa w zwykłym textarea:</p>
        <textarea id="textarea1" placeholder="Wpisz tekst z błędami tutaj...">
Ten tekst zawiera kilka błędów gramatycznych i ortograficznych. Na przykład: "Jestem bardzo zadowony z tego projekta" powinno być "zadowolony z tego projektu". Także "Czy możesz to sprawdzić" może być lepiej sformułowane.
        </textarea>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Edytowalny div (contenteditable)</h2>
        <p>Ten test sprawdza czy rozszerzenie działa z contenteditable elementami (podobnie jak TinyMCE):</p>
        <div id="contenteditable1" contenteditable="true" style="border: 1px solid #ccc; padding: 10px; min-height: 100px; background: white;">
            To jest contenteditabełny div z błędami ortografinymi. Można tu pisać tekst i formatować go. Sprawdz czy rozszerzenie działa prawidowo w tym kontekscie.
        </div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: Symulacja TinyMCE</h2>
        <p>Ten test symuluje zachowanie TinyMCE poprzez przechwycenie prawego kliknięcia:</p>
        <div id="tinymce-simulation" 
             contenteditable="true" 
             style="border: 2px solid #007cba; padding: 15px; min-height: 120px; background: white;"
             data-tinymce-simulation="true">
            Ten edytor symuluje TinyMCE poprzez blokowanie domyślnego menu kontekstowego. Kliknij prawym przyciskiem myszy i zobacz czy nasz content script prawidłowo obsługuje tę sytuację. Tekst ma błędy: "Jestem bardzo zadoony" i "sprawdz czy działa".
        </div>
        <p><em>Ten div blokuje domyślne menu kontekstowe, podobnie jak TinyMCE.</em></p>
    </div>
    
    <div class="test-section">
        <h2>Debug Info</h2>
        <div id="debug-info">
            <p>Status rozszerzenia: <span id="extension-status">Sprawdzanie...</span></p>
            <p>Wykryto content script: <span id="content-script-status">Sprawdzanie...</span></p>
        </div>
    </div>
    
    <script>
        // Simulate TinyMCE behavior - block context menu
        document.getElementById('tinymce-simulation').addEventListener('contextmenu', function(e) {
            console.log('Context menu blocked by TinyMCE simulation');
            e.preventDefault();
            return false;
        });
        
        // Add keyboard event listener to simulate TinyMCE capturing events
        document.getElementById('tinymce-simulation').addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && e.shiftKey && e.key === 'K') {
                console.log('Keyboard shortcut captured by TinyMCE simulation');
                e.preventDefault();
                e.stopPropagation();
                return false;
            }
        });
        
        // Debug functions
        function checkExtensionStatus() {
            if (typeof chrome !== 'undefined' && chrome.runtime) {
                document.getElementById('extension-status').textContent = 'Dostępny';
                document.getElementById('extension-status').style.color = 'green';
            } else {
                document.getElementById('extension-status').textContent = 'Niedostępny';
                document.getElementById('extension-status').style.color = 'red';
            }
        }
        
        function checkContentScript() {
            // This would be set by our content script
            setTimeout(() => {
                if (window.chromeAITextFixerActive) {
                    document.getElementById('content-script-status').textContent = 'Aktywny';
                    document.getElementById('content-script-status').style.color = 'green';
                } else {
                    document.getElementById('content-script-status').textContent = 'Nieaktywny';
                    document.getElementById('content-script-status').style.color = 'red';
                }
            }, 1000);
        }
        
        // Run debug checks
        checkExtensionStatus();
        checkContentScript();
        
        // Add some visual feedback for testing
        document.addEventListener('mouseup', function() {
            const selection = window.getSelection().toString();
            if (selection.length > 0) {
                console.log('Text selected:', selection);
            }
        });
        
        console.log('Test page loaded successfully');
    </script>
</body>
</html>